"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[46],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>b});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),p=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),c=p(a),d=n,b=c["".concat(l,".").concat(d)]||c[d]||m[d]||s;return a?r.createElement(b,i(i({ref:t},u),{},{components:a})):r.createElement(b,i({ref:t},u))}));function b(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,i=new Array(s);i[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[c]="string"==typeof e?e:n,i[1]=o;for(var p=2;p<s;p++)i[p]=a[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"},4820:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>p});var r=a(7462),n=(a(7294),a(3905));const s={slug:"how-to-send-alerts-from-supabase",title:"How to Send Alerts from Supabase",authors:"patrik",tags:["introduction"]},i=void 0,o={permalink:"/emitbase-website/blog/how-to-send-alerts-from-supabase",editUrl:"https://github.com/emitbase/emitbase-website/tree/main/blog/2023-10-25-supabase/index.md",source:"@site/blog/2023-10-25-supabase/index.md",title:"How to Send Alerts from Supabase",description:"Sometimes, you may find the need to be notified about changes in your Supabase database as soon as possible. It can be for various reasons. For example, you may want to know if a new user registered, or if a critical business action occurs, such as a user adding an item to their shopping basket. This tutorial outlines a simple way to achieve this using Emitbase (an open-source alert platform for developers).",date:"2023-10-25T00:00:00.000Z",formattedDate:"October 25, 2023",tags:[{label:"introduction",permalink:"/emitbase-website/blog/tags/introduction"}],readingTime:2.63,hasTruncateMarker:!1,authors:[{name:"Patrik Braborec",title:"Founder of Emitbase",url:"https://github.com/patrikbraborec",imageURL:"https://github.com/patrikbraborec.png",key:"patrik"}],frontMatter:{slug:"how-to-send-alerts-from-supabase",title:"How to Send Alerts from Supabase",authors:"patrik",tags:["introduction"]},nextItem:{title:"Introducing Emitbase (beta) \ud83d\udd25",permalink:"/emitbase-website/blog/introducing-emitbase-beta"}},l={authorsImageUrls:[void 0]},p=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Supabase Table and the Requirements for Alerts",id:"supabase-table-and-the-requirements-for-alerts",level:2},{value:"Step 1: Create a New Emitbase Project",id:"step-1-create-a-new-emitbase-project",level:2},{value:"Step 2: Set Up Your <code>profiles.yml</code>",id:"step-2-set-up-your-profilesyml",level:2},{value:"Step 3: Create Necessary Thresholds for Alerts",id:"step-3-create-necessary-thresholds-for-alerts",level:2},{value:"Step 4: Create Alerts Messages",id:"step-4-create-alerts-messages",level:2},{value:"Step 5: Build and Run Emitbase",id:"step-5-build-and-run-emitbase",level:2},{value:"Showcase",id:"showcase",level:2},{value:"Conclusion",id:"conclusion",level:2}],u={toc:p},c="wrapper";function m(e){let{components:t,...s}=e;return(0,n.kt)(c,(0,r.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Sometimes, you may find the need to be notified about changes in your Supabase database as soon as possible. It can be for various reasons. For example, you may want to know if a new user registered, or if a critical business action occurs, such as a user adding an item to their shopping basket. This tutorial outlines a simple way to achieve this using ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/emitbase/emitbase-core"},"Emitbase")," (an open-source alert platform for developers)."),(0,n.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://nodejs.org/en/blog/release/v18.12.0"},"Node.js 18.12")," or later."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://www.docker.com/"},"Docker")," on your machine."),(0,n.kt)("li",{parentName:"ul"},"Installed ",(0,n.kt)("a",{parentName:"li",href:"https://emitbase.github.io/emitbase-website/docs/getting-started#start-with-emitbase-cli"},"Emitbase CLI"),".")),(0,n.kt)("h2",{id:"supabase-table-and-the-requirements-for-alerts"},"Supabase Table and the Requirements for Alerts"),(0,n.kt)("p",null,"For the sake of simplicity, I have a basic table named ",(0,n.kt)("inlineCode",{parentName:"p"},"buyers")," with the following columns:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"id")," (the table's identifier)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"created_at")," (the registration time of the user)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"updated_at")," (the time of the user's last update)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"name")," (the buyer's name)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"approved")," (a flag indicating if a user has been approved by an admin and can log into the application)")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Example of Supabase table",src:a(9204).Z,width:"1483",height:"315"})),(0,n.kt)("p",null,"I want to receive a Slack message when the following events occur:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"A new buyer registers within the last five minutes."),(0,n.kt)("li",{parentName:"ol"},"The 'buyers' table contains any rows where the 'approved' column has a 'FALSE' value.")),(0,n.kt)("h2",{id:"step-1-create-a-new-emitbase-project"},"Step 1: Create a New Emitbase Project"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"$ npx emitbase init <your-project-name>\n")),(0,n.kt)("h2",{id:"step-2-set-up-your-profilesyml"},"Step 2: Set Up Your ",(0,n.kt)("inlineCode",{parentName:"h2"},"profiles.yml")),(0,n.kt)("p",null,"First, create a credentials file:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"$ touch profiles.yml\n")),(0,n.kt)("p",null,"In the ",(0,n.kt)("inlineCode",{parentName:"p"},"profiles.yml")," file, please define your credentials:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"emitbase:\n  databases:\n    dev:\n      host: <database-host>\n      database: <database-name>\n      port: <database-port>\n      user: <database-username>\n      password: <database-password>\n\n  notifications:\n    dev:\n      slack:\n        port: <slack-port>\n        channel: <slack-channel>\n        signingSecret: <slack-signing-secret>\n        token: <slack-token>\n\n  target: dev\n")),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"Check the ",(0,n.kt)("a",{parentName:"p",href:"https://emitbase.github.io/emitbase-website/docs/guides/integration-with-slack"},"Integration with Slack")," documentation page for more information about Slack credentials.")),(0,n.kt)("h2",{id:"step-3-create-necessary-thresholds-for-alerts"},"Step 3: Create Necessary Thresholds for Alerts"),(0,n.kt)("p",null,"The first threshold must track whether a new buyer has registered within the last five minutes:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},"new_users:\n  expression: SELECT * FROM buyers WHERE created_at >= NOW() - INTERVAL '5 minutes'\n  cron: '* * * * *'\n")),(0,n.kt)("p",null,"The second threshold must track whether the 'buyer' table contains any rows where the ",(0,n.kt)("inlineCode",{parentName:"p"},"approved")," value is ",(0,n.kt)("inlineCode",{parentName:"p"},"FALSE"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},"unapproved_users:\n  expression: 'SELECT * FROM buyers WHERE approved = FALSE'\n  cron: '* * * * *'\n")),(0,n.kt)("h2",{id:"step-4-create-alerts-messages"},"Step 4: Create Alerts Messages"),(0,n.kt)("p",null,"For new users:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},"new_users:\n  slack:\n    message: 'You have new users who have registered on the platform! \ud83d\ude80'\n")),(0,n.kt)("p",null,"For unapproved rows:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yaml"},"unapproved_users:\n  slack:\n    message: '\ud83d\udce3 We have some unapproved users! Take a look!'\n")),(0,n.kt)("h2",{id:"step-5-build-and-run-emitbase"},"Step 5: Build and Run Emitbase"),(0,n.kt)("p",null,"To run the project, it is necessary to build a Docker image:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"$ docker build -t emitbase .\n")),(0,n.kt)("p",null,"Then, you can just run it and wait for notification on your slack! \ud83c\udf89"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"$ docker run -it emitbase\n")),(0,n.kt)("h2",{id:"showcase"},"Showcase"),(0,n.kt)("p",null,"The following images show messages in Slack. It's really simple; you can set up your alerts in minutes!"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Example of Slack messages from Emitbase",src:a(7466).Z,width:"1590",height:"1016"})),(0,n.kt)("h2",{id:"conclusion"},"Conclusion"),(0,n.kt)("p",null,"For more information, please refer to the entire ",(0,n.kt)("a",{parentName:"p",href:"https://emitbase.github.io/emitbase-website/docs/introduction"},"Emitbase documentation"),". If you encounter any issues, please feel free to ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/emitbase/emitbase-core/issues/new"},"create an issue"),". Lastly, if you appreciate Emitbase and would like to show your support, please give it a ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/emitbase/emitbase-core"},"star on GitHub"),". Thank you!"))}m.isMDXComponent=!0},7466:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/slack-messages-449289fa06be645447900c9a35030977.png"},9204:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/supabase-table-c8a7255e1ea1cbfa397806b997192708.png"}}]);